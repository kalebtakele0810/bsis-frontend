<div class="col-sm-3 col-md-2" ng-include="'views/testing/sidebar.html'"></div>
<div class="col-sm-9 col-md-10 main">
  <h3 class="page-header" translate>Find Test Samples</h3>

  <form class="form-horizontal col-sm-12" name="findTestSamplesForm" novalidate ng-submit="findTestSamples()">

    <div class="form-group">
      <label class="col-sm-1 control-label" translate
             translate-comment="Donation Identification Number, abbreviation">
        DIN
      </label>
      <div class="col-sm-11">
        <div class="form-inline">
          <input id="din" class="form-control" style="max-width: 170px"
                 name="din" ng-model="searchParams.din" ng-blur="updateDinSearch()">
        </div>
      </div>
    </div>

    <div class="form-group">
      <label for="venue" class="col-sm-1 control-label" translate>Venue</label>
      <div class="form-inline col-sm-11">            
        <select name="venue" class="form-control" ng-change="updateAllVenues()"  ng-disabled="dinSearch" ng-model="searchParams.venueId" ng-options="item.id as item.name for item in venues track by item.id" style="min-width:170px; width:auto;" ng-required="!searchParams.allVenues">
            <option value="" disabled></option>
        </select>
        <label>
          <input type="checkbox" name="allVenues" ng-model="searchParams.allVenues" ng-click="clearVenue()" ng-disabled="dinSearch" />
          <span translate>All</span>
        </label>
        <div>
            <ng-messages for="findTestSamplesForm.venue.$error" role="alert" ng-show="findTestSamplesForm.$submitted">
              <ng-messages-include src="messages.html"></ng-messages-include>
            </ng-messages>
        </div>
      </div>
    </div>
    
    <div class="form-group">
      <label for="packType" class="col-sm-1 control-label" translate>Pack Type</label>
      <div class="form-inline col-sm-11">            
        <select name="packType" class="form-control" ng-change="updateAllPackTypes()"  ng-disabled="dinSearch" ng-model="searchParams.packTypeId" ng-options="item.id as item.packType for item in packTypes track by item.id" style="min-width:170px; width:auto;" ng-required="!searchParams.allPackTypes">
            <option value="" disabled></option>
        </select>
        <label>
          <input type="checkbox" name="allPackTypes" ng-model="searchParams.allPackTypes" ng-click="clearPackType()" ng-disabled="dinSearch" />
          <span translate>All</span>
        </label>
        <div>
            <ng-messages for="findTestSamplesForm.packType.$error" role="alert" ng-show="findTestSamplesForm.$submitted">
              <ng-messages-include src="messages.html"></ng-messages-include>
            </ng-messages>
        </div>
      </div>
    </div>

    <div class="form-group">
      <label for="startDate" class="col-sm-1 control-label" translate>Period</label>
      <div class="col-sm-11">
        <dateselect name="startDate" ng-model="searchParams.startDate" format="dateFormat" cal-icon="icons.CALENDAR" ng-required="!dinSearch" ng-disabled="dinSearch" ui-date-range="1,months" ui-date-end="{{searchParams.endDate | date:'yyyy-MM-dd HH:mm:ss'}}" ng-class="{'has-error' : (findTestSamplesForm.startDate.$invalid)}" ng-model-options="{ allowInvalid: true }">
        </dateselect><span>&nbsp;<em translate>To</em>&nbsp;</span><dateselect-end name="endDate" ng-model="searchParams.endDate" format="dateFormat" cal-icon="icons.CALENDAR" ng-required="!dinSearch" ng-disabled="dinSearch" ui-date-range="1,months" ui-date-start="{{searchParams.endDate |  date:'yyyy-MM-dd HH:mm:ss'}}" ng-class="{'has-error' : (findTestSamplesForm.endDate.$invalid)}" ng-model-options="{ allowInvalid: true }">
        </dateselect-end>
        <div>
          <ng-messages for="findTestSamplesForm.startDate.$error" role="alert" ng-show="findTestSamplesForm.$submitted">
            <small class="error" ng-message="required"><span translate>Select a valid date</span></small>
            <small class="error" ng-message="datesOutOfRange"><span translate>Select a date range that is less than one month</span></small>
            <ng-messages-include src="messages.html"></ng-messages-include>
          </ng-messages>
          <ng-messages for="findTestSamplesForm.endDate.$error" role="alert" ng-show="findTestSamplesForm.$submitted && !findTestSamplesForm.startDate.$invalid">
            <small class="error" ng-message="required"><span translate>Select a valid date</span></small>
            <ng-messages-include src="messages.html"></ng-messages-include>
          </ng-messages>
        </div>
      </div>
    </div>

    <div class="form-group">
      <div class="col-sm-offset-1 col-sm-3">
        <button class="btn btn-primary" type="submit" ng-disabled="searching">
          {{searching ? "Searching..." : "Search" | translate}}
        </button>
        <button class="btn btn-primary" type="button" ng-click="reset(findTestSamplesForm)" translate>Clear</button>
      </div>
    </div>
  </form>

  <div class="panel panel-default col-sm-12" ng-if="submitted">
    <div class="panel-body">
      <div class="grid" ui-grid="gridOptions" ui-grid-pagination></div>
    </div>
  </div>

</div>
